import{c as G,r as B,j as t,F as K,b as M,L as W,H as X}from"./app-DhMxmlnQ.js";import{q as U}from"./index-DtzRoMoA.js";import{H as R}from"./heading-hZ5llr03.js";import{I as A}from"./input-error-MMwtQsxQ.js";import{B as C}from"./app-logo-icon-X3GIZxfD.js";import{d as Z,c as ee,f as re,g as te,e as se,a as ae,b as le}from"./dialog-BS7NebJX.js";import{I as T}from"./input-BYI6z9RA.js";import{L}from"./label-DLSaM3DW.js";import{a as oe,b as ie,c as ne,A as ce,e as de}from"./app-layout-CNfg1OHM.js";import{S as me}from"./layout-BeytHtzS.js";import{s as ue}from"./index-Cg5q6_j9.js";import{C as fe}from"./copy-DKlyGXFs.js";import{K as he}from"./transition-BKln9b-U.js";/* empty css            */import"./index-B-t1sK0C.js";import"./index-CLgheG93.js";import"./index-DPh8ttYK.js";const l=r=>({url:l.url(r),method:"get"});l.definition={methods:["get","head"],url:"/settings/profile"};l.url=r=>l.definition.url+U(r);l.get=r=>({url:l.url(r),method:"get"});l.head=r=>({url:l.url(r),method:"head"});const V=r=>({action:l.url(r),method:"get"});V.get=r=>({action:l.url(r),method:"get"});V.head=r=>({action:l.url({[r?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...r?.query??r?.mergeQuery??{}}}),method:"get"});l.form=V;const o=r=>({url:o.url(r),method:"patch"});o.definition={methods:["patch"],url:"/settings/profile"};o.url=r=>o.definition.url+U(r);o.patch=r=>({url:o.url(r),method:"patch"});const O=r=>({action:o.url({[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...r?.query??r?.mergeQuery??{}}}),method:"post"});O.patch=r=>({action:o.url({[r?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...r?.query??r?.mergeQuery??{}}}),method:"post"});o.form=O;const i=r=>({url:i.url(r),method:"delete"});i.definition={methods:["delete"],url:"/settings/profile"};i.url=r=>i.definition.url+U(r);i.delete=r=>({url:i.url(r),method:"delete"});const Y=r=>({action:i.url({[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});Y.delete=r=>({action:i.url({[r?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...r?.query??r?.mergeQuery??{}}}),method:"post"});i.form=Y;const z={update:o,destroy:i};function pe(){const r=G.c(9),e=B.useRef(null);let m;r[0]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(R,{variant:"small",title:"Delete account",description:"Delete your account and all of its resources"}),r[0]=m):m=r[0];let u;r[1]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsxs("div",{className:"relative space-y-0.5 text-red-600 dark:text-red-100",children:[t.jsx("p",{className:"font-medium",children:"Warning"}),t.jsx("p",{className:"text-sm",children:"Please proceed with caution, this cannot be undone."})]}),r[1]=u):u=r[1];let s;r[2]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsx(se,{asChild:!0,children:t.jsx(C,{variant:"destructive","data-test":"delete-user-button",children:"Delete account"})}),r[2]=s):s=r[2];let a,h;r[3]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(ae,{children:"Are you sure you want to delete your account?"}),h=t.jsx(le,{children:"Once your account is deleted, all of its resources and data will also be permanently deleted. Please enter your password to confirm you would like to permanently delete your account."}),r[3]=a,r[4]=h):(a=r[3],h=r[4]);let n,c,d;r[5]===Symbol.for("react.memo_cache_sentinel")?(n=z.destroy.form(),c={preserveScroll:!0},d=()=>e.current?.focus(),r[5]=n,r[6]=c,r[7]=d):(n=r[5],c=r[6],d=r[7]);let f;return r[8]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsxs("div",{className:"space-y-6",children:[m,t.jsxs("div",{className:"space-y-4 rounded-lg border border-red-100 bg-red-50 p-4 dark:border-red-200/10 dark:bg-red-700/10",children:[u,t.jsxs(Z,{children:[s,t.jsxs(ee,{children:[a,h,t.jsx(K,{...n,options:c,onError:d,resetOnSuccess:!0,className:"space-y-6",children:p=>{const{resetAndClearErrors:x,processing:y,errors:g}=p;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx(L,{htmlFor:"password",className:"sr-only",children:"Password"}),t.jsx(T,{id:"password",type:"password",name:"password",ref:e,placeholder:"Password",autoComplete:"current-password"}),t.jsx(A,{message:g.password})]}),t.jsxs(re,{className:"gap-2",children:[t.jsx(te,{asChild:!0,children:t.jsx(C,{variant:"secondary",onClick:()=>x(),children:"Cancel"})}),t.jsx(C,{variant:"destructive",disabled:y,asChild:!0,children:t.jsx("button",{type:"submit","data-test":"confirm-delete-user-button",children:"Delete account"})})]})]})}})]})]})]})]}),r[8]=f):f=r[8],f}const xe=[{title:"Profile settings",href:de().url}];function Ae(r){const e=G.c(38),{mustVerifyEmail:m,status:u}=r,{auth:s}=M().props,[a,h]=B.useState(!1);let n,c;e[0]!==a?(n=()=>{if(!a)return;const S=setTimeout(()=>h(!1),2e3);return()=>clearTimeout(S)},c=[a],e[0]=a,e[1]=n,e[2]=c):(n=e[1],c=e[2]),B.useEffect(n,c);let d;e[3]!==s.user.friend_code?(d=async()=>{if(s.user.friend_code)try{await navigator.clipboard.writeText(s.user.friend_code),h(!0)}catch(S){console.error("Failed to copy friend code",S)}},e[3]=s.user.friend_code,e[4]=d):d=e[4];const f=d;let p,x;e[5]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(X,{title:"Profile settings"}),x=t.jsx("h1",{className:"sr-only",children:"Profile Settings"}),e[5]=p,e[6]=x):(p=e[5],x=e[6]);let y;e[7]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx(R,{variant:"small",title:"Friend code",description:"Share this code so friends can invite you to sessions"}),e[7]=y):y=e[7];let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx("p",{className:"text-sm text-muted-foreground",children:"Your friend code"}),e[8]=g):g=e[8];let j;e[9]!==s.user.friend_code?(j=t.jsxs("div",{children:[g,t.jsx("p",{className:"font-mono text-2xl font-semibold tracking-wide",children:s.user.friend_code})]}),e[9]=s.user.friend_code,e[10]=j):j=e[10];let E;e[11]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx(fe,{className:"size-4"}),e[11]=E):E=e[11];const H=a?"Copied":"Copy code";let v;e[12]!==a||e[13]!==f||e[14]!==H?(v=t.jsxs(C,{type:"button",variant:"outline",className:"w-full sm:w-auto",onClick:f,disabled:a,children:[E,H]}),e[12]=a,e[13]=f,e[14]=H,e[15]=v):v=e[15];let _;e[16]!==v||e[17]!==j?(_=t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[j,v]}),e[16]=v,e[17]=j,e[18]=_):_=e[18];let P;e[19]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:"有効なフレンドコードは自動で発行されます。共有して友だち申請に使ってください。"}),e[19]=P):P=e[19];let b;e[20]!==_?(b=t.jsxs("div",{className:"rounded-lg border bg-card p-4 shadow-sm",children:[_,P]}),e[20]=_,e[21]=b):b=e[21];let D;e[22]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx(R,{variant:"small",title:"Profile information",description:"Update your name and email address"}),e[22]=D):D=e[22];let F,k;e[23]===Symbol.for("react.memo_cache_sentinel")?(F=z.update.form(),k={preserveScroll:!0},e[23]=F,e[24]=k):(F=e[23],k=e[24]);let N;e[25]!==s.user.avatar||e[26]!==s.user.email||e[27]!==s.user.email_verified_at||e[28]!==s.user.name||e[29]!==m||e[30]!==u?(N=t.jsx(K,{...F,options:k,encType:"multipart/form-data",className:"space-y-6",children:S=>{const{processing:$,recentlySuccessful:J,errors:I}=S;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(L,{children:"Profile image"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsxs(oe,{className:"h-20 w-20",children:[t.jsx(ie,{src:s.user.avatar,alt:s.user.name}),t.jsx(ne,{children:s.user.name?.slice(0,2).toUpperCase()})]}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsx(T,{id:"avatar",name:"avatar",type:"file",accept:"image/*"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"JPG, PNG などの画像 (最大 2MB)"}),t.jsx(A,{message:I.avatar})]})]})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(L,{htmlFor:"name",children:"Name"}),t.jsx(T,{id:"name",className:"mt-1 block w-full",defaultValue:s.user.name,name:"name",required:!0,autoComplete:"name",placeholder:"Full name"}),t.jsx(A,{className:"mt-2",message:I.name})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(L,{htmlFor:"email",children:"Email address"}),t.jsx(T,{id:"email",type:"email",className:"mt-1 block w-full",defaultValue:s.user.email,name:"email",required:!0,autoComplete:"username",placeholder:"Email address"}),t.jsx(A,{className:"mt-2",message:I.email})]}),m&&s.user.email_verified_at===null&&t.jsxs("div",{children:[t.jsxs("p",{className:"-mt-4 text-sm text-muted-foreground",children:["Your email address is unverified."," ",t.jsx(W,{href:ue(),as:"button",className:"text-foreground underline decoration-neutral-300 underline-offset-4 transition-colors duration-300 ease-out hover:decoration-current! dark:decoration-neutral-500",children:"Click here to resend the verification email."})]}),u==="verification-link-sent"&&t.jsx("div",{className:"mt-2 text-sm font-medium text-green-600",children:"A new verification link has been sent to your email address."})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(C,{disabled:$,"data-test":"update-profile-button",children:"Save"}),t.jsx(he,{show:J,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:t.jsx("p",{className:"text-sm text-neutral-600",children:"Saved"})})]})]})}}),e[25]=s.user.avatar,e[26]=s.user.email,e[27]=s.user.email_verified_at,e[28]=s.user.name,e[29]=m,e[30]=u,e[31]=N):N=e[31];let w;e[32]!==b||e[33]!==N?(w=t.jsxs("div",{className:"space-y-6",children:[y,b,D,N]}),e[32]=b,e[33]=N,e[34]=w):w=e[34];let Q;e[35]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx(pe,{}),e[35]=Q):Q=e[35];let q;return e[36]!==w?(q=t.jsxs(ce,{breadcrumbs:xe,children:[p,x,t.jsxs(me,{children:[w,Q]})]}),e[36]=w,e[37]=q):q=e[37],q}export{Ae as default};
