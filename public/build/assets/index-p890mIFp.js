import{c as G,r as Z,j as s,F as L,H as ee}from"./app-gBwAGQZm.js";import{H as te}from"./heading-DNaXdBm-.js";import{I as se}from"./input-error-BjgQo624.js";import{b as re,B as R}from"./app-logo-icon-BFVMjnla.js";import{C as P,c as O,a as $,b as M,d as U}from"./card-DMJdQ0qf.js";import{I as ie}from"./input-z6iHYEox.js";import{L as ne}from"./label-NO5_o_hj.js";import{A as le,i as de}from"./app-layout-C_A7HpHZ.js";import{q as K,a as J}from"./index-BDqSilVs.js";import{C as oe}from"./copy-BBfLEakk.js";/* empty css            */import"./index-B0y3W_90.js";import"./index-C2sqra8J.js";const ce=[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]],ae=re("UserRoundPlus",ce),l=t=>({url:l.url(t),method:"post"});l.definition={methods:["post"],url:"/friend-requests"};l.url=t=>l.definition.url+K(t);l.post=t=>({url:l.url(t),method:"post"});const V=t=>({action:l.url(t),method:"post"});V.post=t=>({action:l.url(t),method:"post"});l.form=V;const d=(t,e)=>({url:d.url(t,e),method:"patch"});d.definition={methods:["patch"],url:"/friend-requests/{friendRequest}/accept"};d.url=(t,e)=>{(typeof t=="string"||typeof t=="number")&&(t={friendRequest:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={friendRequest:t.id}),Array.isArray(t)&&(t={friendRequest:t[0]}),t=J(t);const n={friendRequest:typeof t.friendRequest=="object"?t.friendRequest.id:t.friendRequest};return d.definition.url.replace("{friendRequest}",n.friendRequest.toString()).replace(/\/+$/,"")+K(e)};d.patch=(t,e)=>({url:d.url(t,e),method:"patch"});const W=(t,e)=>({action:d.url(t,{[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...e?.query??e?.mergeQuery??{}}}),method:"post"});W.patch=(t,e)=>({action:d.url(t,{[e?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...e?.query??e?.mergeQuery??{}}}),method:"post"});d.form=W;const i=(t,e)=>({url:i.url(t,e),method:"delete"});i.definition={methods:["delete"],url:"/friend-requests/{friendRequest}"};i.url=(t,e)=>{(typeof t=="string"||typeof t=="number")&&(t={friendRequest:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={friendRequest:t.id}),Array.isArray(t)&&(t={friendRequest:t[0]}),t=J(t);const n={friendRequest:typeof t.friendRequest=="object"?t.friendRequest.id:t.friendRequest};return i.definition.url.replace("{friendRequest}",n.friendRequest.toString()).replace(/\/+$/,"")+K(e)};i.delete=(t,e)=>({url:i.url(t,e),method:"delete"});const X=(t,e)=>({action:i.url(t,{[e?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...e?.query??e?.mergeQuery??{}}}),method:"post"});X.delete=(t,e)=>({action:i.url(t,{[e?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...e?.query??e?.mergeQuery??{}}}),method:"post"});i.form=X;Object.assign(l,l),Object.assign(d,d),Object.assign(i,i);const me=[{title:"Friends",href:de().url}],ue=()=>{const t=G.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}),t[0]=e):e=t[0],e};function Qe(t){const e=G.c(51),{friendCode:n,friends:C,incomingRequests:a,outgoingRequests:m}=t,c=ue(),[v,Y]=Z.useState(!1);let w;e[0]!==n?(w=async()=>{try{await navigator.clipboard.writeText(n),Y(!0),setTimeout(()=>Y(!1),2e3)}catch(o){console.error("Failed to copy friend code",o)}},e[0]=n,e[1]=w):w=e[1];const z=w;let S;e[2]===Symbol.for("react.memo_cache_sentinel")?(S=s.jsx(ee,{title:"Friends"}),e[2]=S):S=e[2];let A;e[3]===Symbol.for("react.memo_cache_sentinel")?(A=s.jsx(te,{title:"Friends & invites",description:"Share your code, add friends, and manage invitations before starting a session"}),e[3]=A):A=e[3];let F;e[4]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsxs($,{children:[s.jsxs(M,{className:"flex items-center gap-2 text-lg",children:[s.jsx(ae,{className:"size-5"}),"Add a friend by code"]}),s.jsx(U,{children:"自分のフレンドコードを共有するか、相手のコードを入力してリクエストを送信します。"})]}),e[4]=F):F=e[4];let Q;e[5]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx("p",{className:"text-sm text-muted-foreground",children:"Your friend code"}),e[5]=Q):Q=e[5];let u;e[6]!==n?(u=s.jsxs("div",{children:[Q,s.jsx("p",{className:"font-mono text-2xl font-semibold tracking-wide",children:n})]}),e[6]=n,e[7]=u):u=e[7];let E;e[8]===Symbol.for("react.memo_cache_sentinel")?(E=s.jsx(oe,{className:"size-4"}),e[8]=E):E=e[8];const B=v?"Copied":"Copy code";let f;e[9]!==v||e[10]!==z||e[11]!==B?(f=s.jsxs(R,{type:"button",variant:"outline",className:"sm:w-auto",onClick:z,disabled:v,children:[E,B]}),e[9]=v,e[10]=z,e[11]=B,e[12]=f):f=e[12];let p;e[13]!==u||e[14]!==f?(p=s.jsxs("div",{className:"flex flex-col gap-4 rounded-lg border bg-muted/30 p-4 sm:flex-row sm:items-center sm:justify-between",children:[u,f]}),e[13]=u,e[14]=f,e[15]=p):p=e[15];let D;e[16]===Symbol.for("react.memo_cache_sentinel")?(D=s.jsx(L,{...l.form(),resetOnSuccess:["friend_code"],className:"space-y-4",children:ye}),e[16]=D):D=e[16];let h;e[17]!==p?(h=s.jsxs(P,{children:[F,s.jsxs(O,{className:"space-y-6",children:[p,D]})]}),e[17]=p,e[18]=h):h=e[18];let T;e[19]===Symbol.for("react.memo_cache_sentinel")?(T=s.jsxs($,{children:[s.jsx(M,{children:"Incoming requests"}),s.jsx(U,{children:"承認待ちのリクエスト。参加してほしい友だちだけ承認してください。"})]}),e[19]=T):T=e[19];let x;e[20]!==a.length?(x=a.length===0&&s.jsx("p",{className:"text-sm text-muted-foreground",children:"No pending requests right now."}),e[20]=a.length,e[21]=x):x=e[21];let y;if(e[22]!==c||e[23]!==a){let o;e[25]!==c?(o=r=>s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("p",{className:"font-medium",children:r.sender?.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",r.sender?.friend_code]}),r.created_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Sent ",c.format(new Date(r.created_at))]})]}),s.jsxs("div",{className:"mt-4 flex flex-col gap-2 sm:flex-row",children:[s.jsx(L,{...d.form(r.id),children:xe}),s.jsx(L,{...i.form(r.id),children:he})]})]},r.id),e[25]=c,e[26]=o):o=e[26],y=a.map(o),e[22]=c,e[23]=a,e[24]=y}else y=e[24];let j;e[27]!==x||e[28]!==y?(j=s.jsxs(P,{children:[T,s.jsxs(O,{className:"space-y-4",children:[x,y]})]}),e[27]=x,e[28]=y,e[29]=j):j=e[29];let H;e[30]===Symbol.for("react.memo_cache_sentinel")?(H=s.jsxs($,{children:[s.jsx(M,{children:"Outgoing requests"}),s.jsx(U,{children:"まだ承認されていないリクエスト。取り消したい場合はキャンセルできます。"})]}),e[30]=H):H=e[30];let g;e[31]!==m.length?(g=m.length===0&&s.jsx("p",{className:"text-sm text-muted-foreground",children:"No outgoing requests."}),e[31]=m.length,e[32]=g):g=e[32];let b;if(e[33]!==c||e[34]!==m){let o;e[36]!==c?(o=r=>s.jsxs("div",{className:"flex flex-col gap-3 rounded-lg border p-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:r.recipient?.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",r.recipient?.friend_code]}),r.created_at&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Sent ",c.format(new Date(r.created_at))]})]}),s.jsx(L,{...i.form(r.id),children:pe})]},r.id),e[36]=c,e[37]=o):o=e[37],b=m.map(o),e[33]=c,e[34]=m,e[35]=b}else b=e[35];let _;e[38]!==g||e[39]!==b?(_=s.jsxs(P,{children:[H,s.jsxs(O,{className:"space-y-4",children:[g,b]})]}),e[38]=g,e[39]=b,e[40]=_):_=e[40];let N;e[41]!==j||e[42]!==_?(N=s.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[j,_]}),e[41]=j,e[42]=_,e[43]=N):N=e[43];let k;e[44]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsxs($,{children:[s.jsx(M,{children:"Friends list"}),s.jsx(U,{children:"追加済みの友だち。セッション作成時にこのリストから招待できます。"})]}),e[44]=k):k=e[44];let q;e[45]!==C?(q=s.jsxs(P,{children:[k,s.jsx(O,{children:C.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"まだフレンドがいません。コードを共有して追加しましょう。"}):s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:C.map(fe)})})]}),e[45]=C,e[46]=q):q=e[46];let I;return e[47]!==h||e[48]!==N||e[49]!==q?(I=s.jsxs(le,{breadcrumbs:me,children:[S,s.jsxs("div",{className:"space-y-8",children:[A,h,N,q]})]}),e[47]=h,e[48]=N,e[49]=q,e[50]=I):I=e[50],I}function fe(t){return s.jsxs("div",{className:"rounded-lg border p-4",children:[s.jsx("p",{className:"font-medium",children:t.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Code: ",t.friend_code]})]},t.id)}function pe(t){const{processing:e}=t;return s.jsx(R,{type:"submit",variant:"ghost",className:"w-full sm:w-auto",disabled:e,children:"Cancel request"})}function he(t){const{processing:e}=t;return s.jsx(R,{type:"submit",variant:"outline",className:"w-full sm:w-auto",disabled:e,children:"Decline"})}function xe(t){const{processing:e}=t;return s.jsx(R,{type:"submit",className:"w-full sm:w-auto",disabled:e,children:"Accept"})}function ye(t){const{processing:e,errors:n}=t;return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"grid gap-2 sm:grid-cols-[1fr_auto] sm:items-end",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(ne,{htmlFor:"friend_code",children:"Friend code"}),s.jsx(ie,{id:"friend_code",name:"friend_code",placeholder:"e.g. H5KD92PQ",autoComplete:"off",maxLength:12,required:!0}),s.jsx(se,{message:n.friend_code})]}),s.jsx(R,{type:"submit",className:"w-full sm:w-auto",disabled:e,children:"Send request"})]})})}export{Qe as default};
